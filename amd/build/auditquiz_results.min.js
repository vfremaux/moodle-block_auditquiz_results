define(["jquery","core/log","core/config","html2canvas"],function(a,b,c,d){var e={init:function(){a(".auditquiz-results-unbind").bind("click",this.unbind_course),a(".auditquiz-snapshot-btn").bind("click",this.send_image),b.debug("AMD Auditquiz results initialized")},unbind_course:function(b){b.preventDefault();var d=a(this),e=d.attr("id").split("-"),f=e[1],g=e[2],h=e[3],i=c.wwwroot+"/blocks/auditquiz_results/ajax/service.php";i+="?what=unbind",i+="&blockid="+f,i+="&qcatid="+g,i+="&courseid="+h,a.get(i,function(){a("#id-coursebinding-"+g+"-"+h).css("display","none")})},send_image:function(){var b=a(this),e=b.attr("id").split("-"),f=e[2],g=e[3],h="id-auditquiz-"+f+"-"+g;d(a("#"+h),{onrendered:function(b){var d=b.toDataURL(),e=c.wwwroot+"/blocks/auditquiz_results/ajax/service.php",h="?what=storeimage";h+="&imageurl="+d,h+="&blockid="+g,h+="&userid="+f,a.post(e,h,function(){a("#id-snapshot-feedback").html("Snaphot stored")})}})}};return e});