define(["jquery","core/log","html2canvas"],function(a,b,c){var d={init:function(){a(".auditquiz-results-unbind").bind("click",this.unbind_course),a(".auditquiz-snapshot-btn").bind("click",this.send_image),b.debug("AMD Auditquiz results initialized")},unbind_course:function(b){b.preventDefault(),that=a(this),matches=that.attr("id").split("-"),blockid=matches[1],catid=matches[2],courseid=matches[3],url=M.cfg.wwwroot+"/blocks/auditquiz_results/ajax/service.php",url+="?what=unbind",url+="&blockid="+blockid,url+="&qcatid="+catid,url+="&courseid="+courseid,a.get(url,function(b){a("#id-coursebinding-"+catid+"-"+courseid).css("display","none")})},send_image:function(){var b=a(this),d=b.attr("id").split("-"),e=d[2],f=d[3],g="id-auditquiz-"+e+"-"+f;c(a("#"+g),{onrendered:function(b){var c=b.toDataURL(),d=M.cfg.wwwroot+"/blocks/auditquiz_results/ajax/service.php",g="?what=storeimage";g+="&imageurl="+c,g+="&blockid="+f,g+="&userid="+e,a.post(d,g,function(){a("#id-snapshot-feedback").html("Snaphot stored")})}})}};return d});